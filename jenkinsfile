//use for windows os
pipeline {
   agent any
   triggers {
      pollSCM 'H * * * *'
   }
   stages{
      stage('git clone') {
         steps{
            git 'https://github.com/joeren2010/aws_trav_globes.git'
         }
      }
      stage("verify tools") {
         steps{
            bat 'docker --version'               
            bat 'docker info'
            bat 'docker-compose --version'
         }
      }   
      stage("prune docker") {
         steps{
            bat 'docker system prune -a --volumes -f'
         }
      }
      stage("start container") {
         steps{
            bat 'docker-compose up --build -d --wait'
            bat 'docker-compose ps'
         }
      }
   }
   post {
      always{
         bat 'docker-compose down --remove-opphans -v'
         bat 'docker-compose ps'
      }
   }
}


// //use for linux os
// pipeline {
//    agent any
//    triggers {
//       pollSCM '* * * * *'
//    }
//    stages{
//       stage('git clone') {
//          steps{
//             git 'https://github.com/joeren2010/aws_trav_globes.git'
//          }
//       }
//       stage("verify tools") {
//          steps{
//             sh 'docker --version'               
//             sh 'docker info'
//             sh 'docker-compose --version'
//          }
//       }   
//       stage("start container") {
//          steps{
//             sh 'docker-compose up --build --wait'
//             // sh 'docker-compose up --build -d --wait'
//             sh 'docker-compose ps'
//          }
//       }
//    }
//    post {
//       always{
//          bat 'docker-compose down --remove-opphans -v'
//          bat 'docker-compose ps'
//       }
//    }
// }